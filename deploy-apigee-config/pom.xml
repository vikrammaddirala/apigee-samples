<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>com.apigee.edge.config</groupId>
                <artifactId>apigee-config-maven-plugin</artifactId>
                <version>${apigee.config.version}</version>
            </plugin>
        </plugins>
    </pluginManagement>
    <plugins>
        <plugin>
            <artifactId>maven-resources-plugin</artifactId>
            <version>2.6</version>
            <executions>
                <execution>
                    <id>copy-org-config-resources</id>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>
                        <overwrite>true</overwrite>
                        <resources>
                            <resource>
                                <directory>${project.root.dir}/config/org</directory>
                                <filtering>true</filtering>
                            </resource>
                        </resources>
                        <outputDirectory>${target.root.dir}/config/org</outputDirectory>
                    </configuration>
                </execution>
                <execution>
                    <id>copy-env-config-resources</id>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>
                        <overwrite>true</overwrite>
                        <resources>
                            <resource>
                                <directory>${project.root.dir}/config/env/default-dev</directory>
                                <filtering>true</filtering>
                            </resource>
                        </resources>
                        <outputDirectory>${target.root.dir}/config/env/${env}</outputDirectory>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>com.google.code.maven-replacer-plugin</groupId>
            <artifactId>replacer</artifactId>
            <version>1.5.2</version>
            <executions>
                <execution>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>replace</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <basedir>${target.root.dir}</basedir>
                <includes>
                    <include>config/org/apiProducts.json</include>
                </includes>
                <replacements>
                    <replacement>
                        <token>@env</token>
                        <value>${env}</value>
                    </replacement>
                </replacements>
            </plugin>
        <plugin>
            <groupId>com.apigee.edge.config</groupId>
            <artifactId>apigee-config-maven-plugin</artifactId>
            <version>${apigee.config.version}</version>
            <executions>
                <execution>
                    <id>create-config-keyvaluemaps</id>
                    <phase>package</phase>
                    <goals>
                        <goal>keyvaluemaps</goal>
                    </goals>
                </execution>
                <execution>
                    <id>create-config-targetservers</id>
                    <phase>package</phase>
                    <goals>
                        <goal>targetservers</goal>
                    </goals>
                </execution>
                <execution>
                    <id>create-config-apiproducts</id>
                    <phase>install</phase>
                    <goals>
                        <goal>apiproducts</goal>
                    </goals>
                </execution>
                <execution>
                    <id>create-config-developers</id>
                    <phase>install</phase>
                    <goals>
                        <goal>developers</goal>
                    </goals>
                </execution>
                <execution>
                    <id>create-config-apps</id>
                    <phase>install</phase>
                    <goals>
                        <goal>apps</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
